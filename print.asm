%include "print.mac"
%include "syscall.mac"

section .data

DEF_STR_DATA newline, 10

section .text

global print
global print_num

global newline
global newline_len ; generated by DEF_STR_DATA

; rax: pointer to string
; rdx: string length
print:
	call write
	ret

; rax: number
print_num:
	push rbx
	push rbp

	mov rbp, rsp

	mov rbx, 10 ; for idiv

	print_num_loop1:
		mov rdx, 0
		idiv rbx ; divide [rdx:rax] by rbx

		push rdx ; save new digit
		add byte [rsp], '0' ; add code of 0 to get ASCII char code

		cmp rax, 0
		jne print_num_loop1

	print_num_loop2:
		mov rax, rsp
		mov rdx, 1
		call print

		add rsp, 8
		cmp rsp, rbp
		jne print_num_loop2

	mov rsp, rbp

	pop rbp
	pop rbx
	ret

; vim:ft=nasm
